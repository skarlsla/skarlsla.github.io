<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title></title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title">
<meta property="og:url" content="https://skarlsla.github.io/page/3/index.html">
<meta property="og:site_name">
<meta property="og:locale" content="ko">
<meta name="twitter:card" content="summary">
<meta name="twitter:title">
  
    <link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8194749947474200",
    enable_page_level_ads: true
  });
</script>
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo"></a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="검색"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://skarlsla.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-RPC-패턴과-pub-sub패턴에서의-ack-사용차이" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/29/RPC-패턴과-pub-sub패턴에서의-ack-사용차이/" class="article-date">
  <time datetime="2019-04-29T08:03:40.000Z" itemprop="datePublished">2019-04-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/RabbitMq/">RabbitMq</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/29/RPC-패턴과-pub-sub패턴에서의-ack-사용차이/">[RABBITMQ] RPC 패턴과 pub/sub패턴에서의 ack 사용차이</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>기본적으로  noAck, durable 옵션으로 큐에서의 삭제와 ack의 사용을 조정할수있다.</p>
<hr>
<h3 id="1-Publish-Subscribe"><a href="#1-Publish-Subscribe" class="headerlink" title="1.   Publish/Subscribe"></a>1.   Publish/Subscribe</h3><p>로그를 쌓는 서비스를 예를 들어보면</p>
<p>보내는(pub)서버와 처리하는(subs)서버가 있겠다.</p>
<p>pub에서 메세지를 보내고 큐에 쌓인다.  subs 서버는 이를 하나씩 꺼내어 처리한다.</p>
<p>큐에 보낸 메세지를 잃어 버리지 않기 위해서는 durable 옵션으로 큐를 생성하고  </p>
<p>큐에 전송시 persistent 옵션을 주면된다. </p>
<p>그러면 rabbitmq가 죽더라고 큐에 들어간 내용들은 재기동시 다시 살아난다.</p>
<p>하지만 subs서버가 큐에서 꺼낸 메세지를 작업중 죽는다면 메세지는 소실된다.</p>
<p>이를 위해 consume함수 옵션(noAck)을 사용한다. 기본적으로 noAck를 하면 자동으로 ack가 실행되고</p>
<p>큐에서 사라진다. 하지만 noAck 옵션을 false로 선언하면 subs서버에서 작업을 처리한후 ack를 보내야한다.</p>
<p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/ack_client_pub_sub.png" alt="pub/sub"></p>
<hr>
<h3 id="2-RPC-req-res"><a href="#2-RPC-req-res" class="headerlink" title="2.   RPC(req/res)"></a>2.   RPC(req/res)</h3><p>The RPC client must consume in no-ack mode. </p>
<p>This is because there is no queue for the reply message to be returned to</p>
<p>if the client disconnects or rejects the reply message.</p>
<p>RPC 클라이언트는 반드시 consume을 사용할 때 no-ack 모드를 사용해야한다.</p>
<p>클라이언트에서 연결이 끊기거나 reject 에러가 나면 서버에서 전달할 방법이 없기 때문이다.</p>
<p>reply queue는 요청시 생성되고 결과받고 사라지는 임시큐이다.</p>
<p>메세지가 유실되면 안되는 서비스의 처리는 별도로 처리하는 것이 맞겠다.</p>
<p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/ack_client_rpc.png" alt="rpc"></p>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2019/04/29/RPC-패턴과-pub-sub패턴에서의-ack-사용차이/" data-id="cjy7175p4000hdgnv314fxbbm" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ack/">ack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rpc/">rpc</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DEVOPS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/29/DEVOPS/" class="article-date">
  <time datetime="2019-04-29T05:50:24.000Z" itemprop="datePublished">2019-04-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/DevOps/">DevOps</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/29/DEVOPS/">DEVOPS란...</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="DevOps"><a href="#DevOps" class="headerlink" title="DevOps?"></a>DevOps?</h3><p>개발자와 운영자간에 충돌을 해결하기 위한 방법론<br>개발과 운영 간의 프로세스와 도구에 대한 접근을 공유하여 그 차이를 줄이는데 목적을 둔다.<br>개발자와 운영자의 업무뿐만 아니라 QA업무(TEST)에도 포함</p>
<p>Devops란, “엔지니어가, 프로그래밍하고, 빌드하고, 직접 시스템에 배포 및 서비스를 RUN한다. 그리고, 사용자와 끊임 없이 Interaction하면서 서비스를 개선해 나가는 일련의 과정이자 문화이다.”</p>
<hr>
<h3 id="DevOps-작동-방식"><a href="#DevOps-작동-방식" class="headerlink" title="DevOps 작동 방식"></a>DevOps 작동 방식</h3><p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/devops_cycle.png" alt="작동 싸이클"></p>
<p>기존 개발팀은 기획팀이 요구사항을 개발팀에 던지고, 개발팀은 개발 내용을 운영에 던지는, waterfall 모델 처럼, 각 팀이 개발 단계별로 자기 역할을 한 후에, 다음 단계로 던지고 잊어 버리는 (fire &amp; forget)  형태라면, Devops 형태의 개발팀은, 던지는 것이 아니라 과정 내내 같이 수행한다. 요구 사항을 개발팀에 넘겨도, 개발팀과 계속 협의를 하면서 요구 사항을 구체화 하고, 개선하며, 개발중에 운영인원과 같이 협의 하면서 최적의 구조를 논의 하면서 개발이 진행된다.</p>
<hr>
<h3 id="CI-지속적-통합"><a href="#CI-지속적-통합" class="headerlink" title="CI(지속적 통합)"></a>CI(지속적 통합)</h3><p>지속적 통합은 자동화된 빌드 및 테스트가 수행된 후, 개발자가 코드 변경 사항을 중앙 리포지토리에 정기적으로 병합하는 소프트웨어 개발 방식입니다. 지속적 통합의 핵심 목표는 버그를 신속하게 찾아 해결하고, 소프트웨어 품질을 개선하고, 새로운 소프트웨어 업데이트를 검증 및 릴리스하는 데 걸리는 시간을 단축하는 것입니다.</p>
<p>필수요소  = CI 서버(젠킨스) + SCM(GIT) + 빌드툴 + 테스트툴(JUnit, Mocha)</p>
<hr>
<h3 id="CD-지속적-전달"><a href="#CD-지속적-전달" class="headerlink" title="CD(지속적 전달)"></a>CD(지속적 전달)</h3><p>지속적 전달은 코드 변경이 프로덕션에 릴리스할 수 있도록 자동으로 빌드, 테스트 및 준비되는 소프트웨어 개발 방식입니다. 빌드 단계 이후의 모든 코드 변경 사항을 테스트 환경 및/또는 프로덕션 환경에 배포함으로써 지속적 통합을 확장합니다. 지속적 전달이 적절하게 구현되면, 개발자는 언제나 즉시 배포할 수 있고 표준화된 테스트 프로세스를 통과한 빌드 아티팩트를 보유하게 됩니다.</p>
<p>배포툴(ANSIBLE and ANSIBLE Tower)</p>
<hr>
<h3 id="CI-CD의-차이점"><a href="#CI-CD의-차이점" class="headerlink" title="CI/CD의 차이점"></a>CI/CD의 차이점</h3><p>빌드 서버로 코드를 푸쉬 한 후 자동으로 빌드가 시작 되는 지점까지는 CI라 하며, 거기서 테스트를 거쳐 디플로이 과정까지 자동화가 되어있으면 CD라 한다 CD에서 또한 Deploy를 자동으로 해주냐, 수동으로 해주냐에 따라 Delivery, Deployment로 나뉘어집니다.</p>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2019/04/29/DEVOPS/" data-id="cjy7175ou0009dgnvwxaoruaf" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cd/">cd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ci/">ci</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/devops/">devops</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kubernetest_hpa" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/14/kubernetest_hpa/" class="article-date">
  <time datetime="2018-08-14T04:14:35.000Z" itemprop="datePublished">2018-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kubernetes/">Kubernetes</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/14/kubernetest_hpa/">[KUBERNETES] HPA(오토스케일링) 활용법</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-개요"><a href="#1-개요" class="headerlink" title="1. 개요"></a>1. 개요</h3><ul>
<li>애플리케이션을 자동으로 Scale-out 할수 있는 Horizontal Pod Autoscaler 기능</li>
</ul>
<p>CPU 자원설정에 따라 자동으로 pod의 숫자를 scale-up 한다.</p>
<hr>
<h3 id="2-deployment-작성"><a href="#2-deployment-작성" class="headerlink" title="2. deployment 작성"></a>2. deployment 작성</h3><ul>
<li>back-end-rolling-deployment.yaml<pre><code class="bash">apiVersion: apps/v1beta2
kind: Deployment
metadata:
name: rolling-update-test
labels:
  app: web-front-end
spec:
replicas: 1
minReadySeconds: 10
strategy:
  <span class="built_in">type</span>: RollingUpdate
  rollingUpdate:
    maxUnavailable: 50%
selector:
  matchLabels:
    app: web-front-end
template:
  metadata:
    labels:
      app: web-front-end
      department: group3
  spec:
    containers:
    - name: m-client-rolling
      image: skarl/client:latest
      env:
      - name: PORT_ARGS
        value: <span class="string">"--port=80"</span>
      ports:
      - containerPort: 80
        name: web-port
        protocol: TCP
      resources:
        requests:
          memory: <span class="string">"256Mi"</span>
          cpu: <span class="string">"200m"</span>
        limits:
          memory: <span class="string">"1Gi"</span>
          cpu: <span class="string">"500m"</span>
</code></pre>
</li>
</ul>
<hr>
<p>Resources Requests 사용량 설정 필수<br>resources.requests.cpu 부분에 CPU 자원을 200m(milli-cores) 또는 0.2로 요청</p>
<hr>
<h3 id="2-hpa-작성"><a href="#2-hpa-작성" class="headerlink" title="2. hpa 작성"></a>2. hpa 작성</h3><ul>
<li>hpa-deployment.yaml</li>
</ul>
<pre><code class="bash">apiVersion: autoscaling/v1
kind: HorizontalPodAutoscaler
metadata:
  name: rolling-update-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1beta2
    kind: Deployment
    name: rolling-update-test
  maxReplicas: 10
  minReplicas: 1
  targetCPUUtilizationPercentage: 10
</code></pre>
<p>scaleTargetRef: 대상설정<br>minReplicas: 최소pod<br>maxReplicas: 최대pod<br>targetCPUUtilizationPercentage: CPU 사용 임계치 %로설정 넘어서면 업스케일 동작</p>
<h3 id="3-모니터링-및-테스트"><a href="#3-모니터링-및-테스트" class="headerlink" title="3. 모니터링 및 테스트"></a>3. 모니터링 및 테스트</h3><ul>
<li>부하테스트를 통해 cpu 사용량 늘리고</li>
</ul>
<p>while true; do wget q -O <a href="https://rolling.test.com:30100/coin/list" target="_blank" rel="noopener">https://rolling.test.com:30100/coin/list</a>; done</p>
<ul>
<li>명령어로 모니터링 kubectl get hpa -w</li>
</ul>
<p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/hpa-w.PNG" alt="Alt text"></p>
<ul>
<li>대쉬보드에서 확장된 pods 확인</li>
</ul>
<p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/hpa-pods-incre.PNG" alt="Alt text"></p>
<hr>
<h3 id="4-사용중-CPU-gt-UNKnown-일때-해결방법"><a href="#4-사용중-CPU-gt-UNKnown-일때-해결방법" class="headerlink" title="4. 사용중 CPU -&gt; UNKnown 일때 해결방법"></a>4. 사용중 CPU -&gt; UNKnown 일때 해결방법</h3><ul>
<li>메트릭 api 존재유무 확인</li>
</ul>
<pre><code class="bash">kubectl get --raw /apis/metrics.k8s.io/v1beta1/nodes
</code></pre>
<ul>
<li>메트릭 서버 설치</li>
</ul>
<p>git clone <a href="https://github.com/kubernetes-incubator/metrics-server.git" target="_blank" rel="noopener">https://github.com/kubernetes-incubator/metrics-server.git</a><br>cd metrics-server/<br>kubectl create -f deploy/1.8+/</p>
<ul>
<li>설치 후 확인</li>
</ul>
<p>[root@tweb01 ~] kubectl get –raw “/apis/metrics.k8s.io/v1beta1/nodes” {“kind”:”NodeMetricsList”,”apiVersion”:”metrics.k8s.io/v1beta1”,”metadata”:{“selfLink”:”/apis/metrics.k8s.io/v1beta1/nodes”},”items”:[{“metadata”:{“name”:”tweb01.freebex.com”,”selfLink”:”/apis/metrics.k8s.io/v1beta1/nodes/tweb01.freebex.com”,”creationTimestamp”:”2018-06-28T07:27:00Z”},”timestamp”:”2018-06-28T07:26:00Z”,”window”:”1m0s”,”usage”:{“cpu”:”116m”,”memory”:”2454816Ki”}},{“metadata”:{“name”:”tweb02.freebex.com”,”selfLink”:”/apis/metrics.k8s.io/v1beta1/nodes/tweb02.freebex.com”,”creationTimestamp”:”2018-06-28T07:27:00Z”},”timestamp”:”2018-06-28T07:26:00Z”,”window”:”1m0s”,”usage”:{“cpu”:”76m”,”memory”:”1818256Ki”}}]}</p>
<ul>
<li>kubernetes 설정파일 수정</li>
</ul>
<p>vi /etc/kubernetes/manifests/kube-controller-manager.yaml</p>
<p>controller-manager 옵션에 추가</p>
<ul>
<li>–horizontal-pod-autoscaler-use-rest-clients=true</li>
</ul>
<p>그래도 unknown이 나오면 재실행 해보고 부하를 줘보고 기다려보면 나온다.</p>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/08/14/kubernetest_hpa/" data-id="cjy7175q7001odgnvzr8aqw29" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kubernetest_rolling" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/04/kubernetest_rolling/" class="article-date">
  <time datetime="2018-08-04T08:54:33.000Z" itemprop="datePublished">2018-08-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kubernetes/">Kubernetes</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/04/kubernetest_rolling/">[KUBERNETES] 무중단배포 rolling update strategy</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-개요"><a href="#1-개요" class="headerlink" title="1. 개요"></a>1. 개요</h3><p>서비스 중단 없이 애플리케이션을 업데이트 하기 위해서, Kubernetes에서는 rolling update라는 기능을 지원합니다. 이 기능을 통해서 전체 Pod을 일시에 중단/업데이트 하는 것이 아니라, 한번에 n개씩 Pod을 순차적으로 업데이트할 수 있습니다. 이를 통해 서비스 중단 현상 없이 애플리케이션 버전 업데이트 및 롤백을 할 수 있습니다.</p>
<hr>
<h3 id="2-deployment-작성"><a href="#2-deployment-작성" class="headerlink" title="2. deployment 작성"></a>2. deployment 작성</h3><ul>
<li>back-end-rolling-deployment.yaml<pre><code class="bash">apiVersion: apps/v1beta1
kind: Deployment
metadata:
name: rolling-update-test
spec:
replicas: 3
minReadySeconds: 10
strategy:
  <span class="built_in">type</span>: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0
template:
  metadata:
    labels:
      app: web-front-end
      department: group3
  spec:
    containers:
    - name: m-client-web
      image: skarl/client:latest
      env:
      - name: PORT_ARGS
        value: <span class="string">"--port=80"</span>
      ports:
      - containerPort: 80
        name: web-port
        protocol: TCP
</code></pre>
</li>
</ul>
<hr>
<p>minReadySeconds : pod이 Ready 단계 부터 Available 단계 까지 식단 차이 시간을 설정하지 않으면 ready에서 곧바로 avaliable이 되고 순단 현상이 일어난다. 적절한 시간을 테스트하여 설정하는것이 좋다.</p>
<p>strategy.type : “Recreate” or “RollingUpdate”를 설정가능. 기본값은 “RollingUpdate”, Recreate의 경우 Pod가 삭제된 후 재생성</p>
<p>strategy.rollingUpdate.maxSurge : rolling update 중 정해진 Pod 수 이상으로 만들 수 있는 Pod의 최대 개수. 기본값은 25%</p>
<p>strategy.rollingUpdate.maxUnavailable : rolling update 중 unavailable 상태인 Pod의 최대 개수를 설정. rollgin update 중 사용할 수 없는 Pod의 최대 개수. 값은 0보다 큰 정수를 통해 Pod의 절대 개수 설정이 가능하고, “25%“와 같이 percentage 표현 가능 . maxUnavailable에서 percentage 계산은 rounding down(내림) 방식이며 기본값은 25% 이다. maxSurge와 maxUnavailable 값이 동시에 0이 될 수 없다.</p>
<hr>
<h3 id="3-배포-테스트"><a href="#3-배포-테스트" class="headerlink" title="3. 배포 테스트"></a>3. 배포 테스트</h3><ul>
<li>운영중인 상태</li>
</ul>
<p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/rolling-pre-dashboard.PNG" alt="Alt text"></p>
<hr>
<ul>
<li>rolling update 중인 상태</li>
</ul>
<p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/rolling-ing.PNG" alt="Alt text"></p>
<hr>
<ul>
<li>update 완료 상태</li>
</ul>
<p><img src="https://raw.githubusercontent.com/skarlsla/skarlsla.github.io/master/css/image/rolling-post-dashboard.PNG" alt="Alt text"></p>
<hr>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/08/04/kubernetest_rolling/" data-id="cjy7175qe001vdgnvkfn34lwj" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kubernetes_ingress_https" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/28/kubernetes_ingress_https/" class="article-date">
  <time datetime="2018-07-28T04:10:53.000Z" itemprop="datePublished">2018-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kubernetes/">Kubernetes</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/28/kubernetes_ingress_https/">[KUBERNETES] nginx-ingress ssl 적용</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-secret-생성"><a href="#1-secret-생성" class="headerlink" title="1. secret 생성"></a>1. secret 생성</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create secret tls <span class="built_in">test</span>-secret --key _test_SHA256WITHRSA.key --cert test_ssl.crt</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-ingress-rule-수정"><a href="#2-ingress-rule-수정" class="headerlink" title="2. ingress rule 수정"></a>2. ingress rule 수정</h3><ul>
<li>default-back-end-service.yaml<pre><code class="bash">apiVersion: extensions/v1beta1
kind: Ingress
metadata:
name: nginx-ingress
namespace: default
spec:
tls:
- hosts:
  - www.test.com
  - m.test.com
  secretName: <span class="built_in">test</span>-secret
rules:
- host: [svc1 도메인]
  http:
    paths:
    - backend:
        serviceName: backend-svc-1
        servicePort: 80
- host: [svc2 도메인]
  http:
    paths:
    - backend:
        serviceName: backend-svc-2
        servicePort: 80
- host: [통합 도메인]
  http:
    paths:
    - path: /svc1
      backend:
        serviceName: backend-svc-1
        servicePort: 80
    - path: /svc2
      backend:
        serviceName: backend-svc-2
        servicePort: 80
    - path: /nginx_status
      backend:
        serviceName: nginx-ingress-nodeport
        servicePort: 18080
</code></pre>
</li>
</ul>
<hr>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/07/28/kubernetes_ingress_https/" data-id="cjy7175ps0015dgnvaasiu4ln" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ingress/">ingress</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-algori" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/26/algori/" class="article-date">
  <time datetime="2018-07-26T05:39:13.000Z" itemprop="datePublished">2018-07-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/26/algori/">알고리즘 연습문제</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-slice-max"><a href="#1-slice-max" class="headerlink" title="1. slice max"></a>1. slice max</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 정수값을 가진 배열이 있을 때, 임의의 x,y,z 값을 정하고, 0&lt;= x &lt; y &lt; z &lt;= arr.length 라고 정의한다.</span></span><br><span class="line"><span class="comment">문제) a[x+1]에서 a[y-1] 사이의 값들과 a[y+1]에서 a[z-1] 사이의 값을 모두 더했을 때 최대값은 무엇인지 구하시오.</span></span><br><span class="line"><span class="comment">function slice(arr)</span></span><br><span class="line"><span class="comment">(3 &lt;= arr.length &lt;= 100,000)</span></span><br><span class="line"><span class="comment">(-10,000 &lt;= n &lt;= 10,000)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">예를 들어 a = [3,2,6, -1,4,5, -1,2] 일 때,</span></span><br><span class="line"><span class="comment">(x=0, y=3, z=6) 일 때 a[1] + a[2] + a[4] + a[5] =&gt; 2 + 6 + 4 + 5 = 17,</span></span><br><span class="line"><span class="comment">(0, 3, 7) a[1] + a[2] + a[4] + a[5] + a[6] =&gt; 2 + 6 + 4 + 5 − 1 = 16,</span></span><br><span class="line"><span class="comment">(3, 4, 5) 사이 값이 없으므로 0.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">따라서 최대값은 17이 된다. */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">slice_origin</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sum = <span class="number">0</span> ;</span><br><span class="line">    <span class="comment">// x = 0~ arr.length-3</span></span><br><span class="line">    <span class="comment">// y = 1~ arr.length-2</span></span><br><span class="line">    <span class="comment">// z = 2~ arr.length-1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> x=<span class="number">0</span>; x&lt;arr.length<span class="number">-3</span>; x++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> y=<span class="number">0</span>; y&lt;arr.length<span class="number">-2</span>; y++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> z=<span class="number">0</span>; z&lt;arr.length<span class="number">-1</span>; z++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(x&lt;y &amp;&amp; y&lt;z)&#123;</span><br><span class="line">                    <span class="keyword">var</span> temp_sum = sums(x,y,z,arr);</span><br><span class="line">                    <span class="keyword">if</span>(sum &lt; temp_sum)&#123;</span><br><span class="line">                        sum = temp_sum;         </span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">"==="</span>);               </span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">"sum"</span>+sum);</span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">"==="</span>);     </span><br><span class="line">                        <span class="built_in">console</span>.log(x,y,z);</span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">"==="</span>);     </span><br><span class="line">                    &#125;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sums</span>(<span class="params">x,y,z,arr</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> xy = arr.slice(x+<span class="number">1</span>,y);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;xy.length; i++)&#123;          </span><br><span class="line">            sum += xy[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> yz = arr.slice(y+<span class="number">1</span>,z);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>; j&lt;yz.length; j++)&#123;</span><br><span class="line">            sum += yz[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">-3</span>,<span class="number">-1</span>,<span class="number">10</span>,<span class="number">-6</span>,<span class="number">-3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">-1</span>,<span class="number">-5</span>,<span class="number">-1</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">-5</span>,<span class="number">-1</span>,<span class="number">-5</span>,<span class="number">-11111</span>,<span class="number">-2</span>,<span class="number">0</span>,<span class="number">-9</span>,<span class="number">-10</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">-1</span>];<span class="comment">//  [200,6,1,4,5,1,10,2,4,6,-100,-10000] ;</span></span><br><span class="line">slice_origin(arr);</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-bracket"><a href="#2-bracket" class="headerlink" title="2. bracket"></a>2. bracket</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Visual Studio Code와 유사한 Editor+++라는 에디터가 있다.</span></span><br><span class="line"><span class="comment">Visual Studio Code에서는 괄호를 입력하면 자동으로 닫는 괄호가 입력되는 것처럼 Editor+++도 자동으로 괄호를 닫는다.</span></span><br><span class="line"><span class="comment">그런데 Editor+++는 가끔 버그로 인해 닫는 괄호를 늦게 다는 경우가 있다. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">여기에 Editor+++에서 작성한 텍스트가 있는데 이 텍스트를 Visual Studio Code로 복사하고자 하는데</span></span><br><span class="line"><span class="comment">이 때 괄호가 올바른지 아래와 같이 검증하고자 한다.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">예를 들어 (), &#123;()&#125; &#123;()()&#125; 처럼 입력할 때 닫는 괄호가 올바르게 표시되며 이는 올바른 형태이다.</span></span><br><span class="line"><span class="comment">그러나 ([)()] 의 경우 모두 쌍은 맞으나 괄호가 올바를 위치에 있지 않으므로 이는 올바르지 않은 형태이다.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">문제) Editor+++에서 작성한 괄호값을 가진 임의의 텍스트가 있을 때, Visual Studio Code에서 인식이 가능한지 파악하고, 가능하면 true, 불가능하면 false를 출력하라. */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bracket_replace</span>(<span class="params">str</span>)</span>&#123;    </span><br><span class="line">    <span class="keyword">var</span> result = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(str.length%<span class="number">2</span>==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> startlength = str.length;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        str = str.replace(<span class="regexp">/\(\)|\&#123;\&#125;|\[\]/g</span>,<span class="string">''</span>);</span><br><span class="line">        <span class="keyword">if</span>(str.length==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span>(str.length == startlength) result = <span class="literal">false</span>;</span><br><span class="line">        startlength=str.length;</span><br><span class="line">    &#125; <span class="keyword">while</span> (result);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-count-arr"><a href="#3-count-arr" class="headerlink" title="3. count arr"></a>3. count arr</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 배열 A가 있다. 이 배열은 배열 B의 몇번째 위치에 값을 증가(++) 시켜야 하는지에 대한 정보를 담고 있다.</span></span><br><span class="line"><span class="comment">예를 들어 a = [3,4,4,5,1,4,4] 인 배열이 있다고 할 때,</span></span><br><span class="line"><span class="comment">a[0]= 3 이므로 배열의 3번째 값을 증가 시켜라 (0,0,1,0,0)</span></span><br><span class="line"><span class="comment">a[1]= 4 이므로 배열의 4번째 값을 증가 시켜라 (0,0,1,1,0)</span></span><br><span class="line"><span class="comment">a[2]= 4 이므로 배열의 4번째 값을 증가 시켜라 (0,0,1,2,0)</span></span><br><span class="line"><span class="comment">이 것을 반복하면 배열 B는 [1,0,1,4,1] 값을 갖는다. */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count_arr</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> max = arr.reduce( <span class="function"><span class="keyword">function</span> (<span class="params">previous, current</span>) </span>&#123; </span><br><span class="line">		<span class="keyword">return</span> previous &gt; current ? previous:current;</span><br><span class="line">	&#125;);</span><br><span class="line">    <span class="keyword">var</span> return_arr = <span class="keyword">new</span> <span class="built_in">Array</span>(max);</span><br><span class="line">    return_arr.fill(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> val <span class="keyword">of</span> arr)&#123;</span><br><span class="line">        return_arr[val<span class="number">-1</span>] = return_arr[val<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> return_arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-quick-sort"><a href="#4-quick-sort" class="headerlink" title="4. quick sort"></a>4. quick sort</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.quickSort = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> r = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> less = [], greater = [];</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> pivot = r.splice(<span class="built_in">Math</span>.floor(r.length / <span class="number">2</span>),<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"중간지점값:"</span>+pivot);</span><br><span class="line">     <span class="comment">// 중간값 기준 작은 값 or 큰 값</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = r.length - <span class="number">1</span> ; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">      <span class="keyword">if</span> ( r[i] &lt;= pivot) &#123;</span><br><span class="line">        less.push(r[i]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        greater.push(r[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">var</span> c = [];</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> c.concat(less.quickSort(), pivot, greater.quickSort());</span><br><span class="line">  </span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> a = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">43</span>,<span class="number">5</span>,<span class="number">123</span>,<span class="number">6</span>,<span class="number">231</span>,<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">console</span>.log(a.quickSort());</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/07/26/algori/" data-id="cjy7175pn000zdgnvdeo2mrus" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kubernetes_ingressLB" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/25/kubernetes_ingressLB/" class="article-date">
  <time datetime="2018-07-25T06:30:13.000Z" itemprop="datePublished">2018-07-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kubernetes/">Kubernetes</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/25/kubernetes_ingressLB/">[KUBERNETES] nginx 컨테이너를 활용한 ingress load balancer 구성</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-테스트용-웹-백엔드-생성"><a href="#1-테스트용-웹-백엔드-생성" class="headerlink" title="1. 테스트용 웹 백엔드 생성"></a>1. 테스트용 웹 백엔드 생성</h3><ul>
<li>back-end-deployment.yaml<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: deploy-test-1</span><br><span class="line">spec:</span><br><span class="line">  replicas: 2</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: web-front-end</span><br><span class="line">        department: group1</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: m-client-web</span><br><span class="line">        image: xxx/client:latest</span><br><span class="line">        env:</span><br><span class="line">        - name: PORT_ARGS</span><br><span class="line">          value: <span class="string">"--port=80"</span></span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 80</span><br><span class="line">          name: web-port</span><br><span class="line">          protocol: TCP</span><br><span class="line">---</span><br><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: deploy-test-2</span><br><span class="line">spec:</span><br><span class="line">  replicas: 2</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: web-front-end</span><br><span class="line">        department: group2</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: tiny-webserver-2</span><br><span class="line">        image: xxx/node-api:latest</span><br><span class="line">        env:</span><br><span class="line">        - name: PORT_ARGS</span><br><span class="line">          value: <span class="string">"--port=3501"</span></span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 3501</span><br><span class="line">          name: web-port</span><br><span class="line">          protocol: TCP</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>back-end-service.yaml<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: backend-svc-1</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 80</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: web-port</span><br><span class="line">  selector:</span><br><span class="line">    app: web-front-end</span><br><span class="line">    department: group1</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: backend-svc-2</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 80</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: web-port</span><br><span class="line">  selector:</span><br><span class="line">    app: web-front-end</span><br><span class="line">    department: group2</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>실행<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f back-end-deployment.yaml</span><br><span class="line">kubectl apply -f back-end-service.yaml</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h3 id="2-테스트용-ingress용-백엔드-생성"><a href="#2-테스트용-ingress용-백엔드-생성" class="headerlink" title="2. 테스트용 ingress용 백엔드 생성"></a>2. 테스트용 ingress용 백엔드 생성</h3><ul>
<li><p>default-back-end-deployment.yaml</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: default-http-backend</span><br><span class="line">spec:</span><br><span class="line">  replicas: 2</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: default-http-backend</span><br><span class="line">    spec:</span><br><span class="line">      terminationGracePeriodSeconds: 60</span><br><span class="line">      containers:</span><br><span class="line">      - name: default-http-backend</span><br><span class="line">        <span class="comment"># Any image is permissable as long as:</span></span><br><span class="line">        <span class="comment"># 1. It serves a 404 page at /</span></span><br><span class="line">        <span class="comment"># 2. It serves 200 on a /healthz endpoint</span></span><br><span class="line">        image: gcr.io/google_containers/defaultbackend:1.0</span><br><span class="line">        livenessProbe:</span><br><span class="line">          httpGet:</span><br><span class="line">            path: /healthz</span><br><span class="line">            port: 8080</span><br><span class="line">            scheme: HTTP</span><br><span class="line">          initialDelaySeconds: 30</span><br><span class="line">          timeoutSeconds: 5</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 8080</span><br><span class="line">        resources:</span><br><span class="line">          limits:</span><br><span class="line">            cpu: 10m</span><br><span class="line">            memory: 20Mi</span><br><span class="line">          requests:</span><br><span class="line">            cpu: 10m</span><br><span class="line">            memory: 20Mi</span><br></pre></td></tr></table></figure>
</li>
<li><p>default-back-end-service.yaml</p>
</li>
</ul>
<pre><code class="bash">apiVersion: v1
kind: Service
metadata:
  name: default-http-backend
spec:
  <span class="built_in">type</span>: ClusterIP
  ports:
  - port: 80
    protocol: TCP
    targetPort: 8080
  selector:
    app: default-http-backend
</code></pre>
<hr>
<ul>
<li>실행<pre><code class="bash">kubectl apply -f default-back-end-deployment.yaml
kubectl apply -f default-back-end-service.yaml
</code></pre>
</li>
</ul>
<hr>
<h3 id="4-Nginx-Ingress-Controller-설정값-저장을-위한-Configmap-등록"><a href="#4-Nginx-Ingress-Controller-설정값-저장을-위한-Configmap-등록" class="headerlink" title="4. Nginx Ingress Controller 설정값 저장을 위한 Configmap 등록"></a>4. Nginx Ingress Controller 설정값 저장을 위한 Configmap 등록</h3><ul>
<li>configmap.yaml<pre><code class="bash">apiVersion: v1
kind: ConfigMap
metadata:
name: nginx-ingress-controller-conf
labels:
  app: nginx-ingress-lb
  group: lb
data:
<span class="comment"># for VTS page of the Nginx load balancer</span>
<span class="built_in">enable</span>-vts-status: <span class="string">'true'</span>
<span class="built_in">enable</span>-sticky-sessions: <span class="string">'true'</span>
</code></pre>
</li>
</ul>
<hr>
<h3 id="5-Nginx-Ingress-Controller-생성"><a href="#5-Nginx-Ingress-Controller-생성" class="headerlink" title="5. Nginx Ingress Controller 생성"></a>5. Nginx Ingress Controller 생성</h3><ul>
<li>SA, ClusterRole, ClusterRoleBinding</li>
</ul>
<pre><code class="bash"><span class="comment"># Add: SA, ClusterRole, ClusterRoleBinding</span>
<span class="comment"># Name Space: default</span>
apiVersion: v1
kind: ServiceAccount
metadata:
  name: ingress
  namespace: default

apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRole
metadata:
  name: system:ingress
rules:
- apiGroups:
  - <span class="string">""</span>
  resources: [<span class="string">"configmaps"</span>,<span class="string">"secrets"</span>,<span class="string">"endpoints"</span>,<span class="string">"events"</span>,<span class="string">"services"</span>]
  verbs: [<span class="string">"list"</span>,<span class="string">"watch"</span>,<span class="string">"create"</span>,<span class="string">"update"</span>,<span class="string">"delete"</span>,<span class="string">"get"</span>]
- apiGroups:
  - <span class="string">""</span>
  - <span class="string">"extensions"</span>
  resources: [<span class="string">"services"</span>,<span class="string">"nodes"</span>,<span class="string">"ingresses"</span>,<span class="string">"pods"</span>,<span class="string">"ingresses/status"</span>]
  verbs: [<span class="string">"list"</span>,<span class="string">"watch"</span>,<span class="string">"create"</span>,<span class="string">"update"</span>,<span class="string">"delete"</span>,<span class="string">"get"</span>]

apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: ingress
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:ingress
subjects:
  - kind: ServiceAccount
    name: ingress
    <span class="comment"># Could be like 'kube-system' ...</span>
    namespace: default

</code></pre>
<hr>
<ul>
<li>deployment</li>
</ul>
<pre><code class="bash">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx-ingress-controller
  <span class="comment"># Could be like 'kube-system' ...</span>
  namespace: default
spec:
  replicas: 2
  revisionHistoryLimit: 3
  template:
    metadata:
      labels:
        app: nginx-ingress-lb
    spec:
      serviceAccountName: ingress
      terminationGracePeriodSeconds: 60
      containers:
        - name: nginx-ingress-controller
          image: gcr.io/google_containers/nginx-ingress-controller:0.9.0-beta.2
          imagePullPolicy: IfNotPresent
          readinessProbe:
            httpGet:
              path: /healthz
              port: 18080
              scheme: HTTP
          livenessProbe:
            httpGet:
              path: /healthz
              port: 18080
              scheme: HTTP
            initialDelaySeconds: 10
            timeoutSeconds: 5
          args:
            - /nginx-ingress-controller
            - --default-backend-service=$(POD_NAMESPACE)/default-http-backend
            - --configmap=$(POD_NAMESPACE)/nginx-ingress-controller-conf
          env:
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
          ports:
            - containerPort: 443
            - containerPort: 18080

</code></pre>
<h3 id="5-Ingress-Rule-디플로이"><a href="#5-Ingress-Rule-디플로이" class="headerlink" title="5. Ingress Rule 디플로이"></a>5. Ingress Rule 디플로이</h3><ul>
<li>default-back-end-service.yaml<pre><code class="bash">apiVersion: extensions/v1beta1
kind: Ingress
metadata:
name: nginx-ingress
namespace: default
spec:
rules:
- host: [svc1 도메인]
  http:
    paths:
    - backend:
        serviceName: backend-svc-1
        servicePort: 80
- host: [svc2 도메인]
  http:
    paths:
    - backend:
        serviceName: backend-svc-2
        servicePort: 80
- host: [통합 도메인]
  http:
    paths:
    - path: /svc1
      backend:
        serviceName: backend-svc-1
        servicePort: 80
    - path: /svc2
      backend:
        serviceName: backend-svc-2
        servicePort: 80
    - path: /nginx_status
      backend:
        serviceName: nginx-ingress-nodeport
        servicePort: 18080
</code></pre>
</li>
</ul>
<hr>
<h3 id="참고링크"><a href="#참고링크" class="headerlink" title="참고링크"></a>참고링크</h3><p><a href="https://tistory3.daumcdn.net/tistory/467568/skin/images/Ingress-concept-and-logical-arch-v01.png" target="_blank" rel="noopener">Ingress Load Balancer 개념도</a></p>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/07/25/kubernetes_ingressLB/" data-id="cjy7175pz001cdgnvfhtco551" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ingress/">ingress</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-redis_pod" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/25/redis_pod/" class="article-date">
  <time datetime="2018-07-25T06:26:13.000Z" itemprop="datePublished">2018-07-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kubernetes/">Kubernetes</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/25/redis_pod/">[KUBERNETES] redis simple deployment 및 service 작성</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-deployment-및-service-yaml-작성"><a href="#1-deployment-및-service-yaml-작성" class="headerlink" title="1. deployment 및 service  yaml 작성"></a>1. deployment 및 service  yaml 작성</h3><ul>
<li>deployment<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">extensions/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">redis-test</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  template:</span></span><br><span class="line"><span class="attr">    metadata:</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">        app:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">    spec:</span></span><br><span class="line"><span class="attr">      containers:</span></span><br><span class="line"><span class="attr">      - name:</span> <span class="string">master</span></span><br><span class="line"><span class="attr">        image:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">        resources:</span></span><br><span class="line"><span class="attr">          requests:</span></span><br><span class="line"><span class="attr">            cpu:</span> <span class="number">100</span><span class="string">m</span></span><br><span class="line"><span class="attr">            memory:</span> <span class="number">100</span><span class="string">Mi</span></span><br><span class="line"><span class="attr">        ports:</span></span><br><span class="line"><span class="attr">        - containerPort:</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>service<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">redis-test</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    app:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">  ports:</span></span><br><span class="line"><span class="attr">    - protocol:</span> <span class="string">TCP</span></span><br><span class="line"><span class="attr">      port:</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/07/25/redis_pod/" data-id="cjy7175sq003vdgnv7ms5ziyx" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/25/docker/" class="article-date">
  <time datetime="2018-07-25T05:22:13.000Z" itemprop="datePublished">2018-07-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/docker/">docker</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/25/docker/">docker build &amp; push to docker-hub</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-docker-이미지-추출"><a href="#1-docker-이미지-추출" class="headerlink" title="1. docker 이미지 추출"></a>1. docker 이미지 추출</h3><ul>
<li>node.js<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FROM node:9.4-alpine</span><br><span class="line">MAINTAINER authorize &lt;xxx@gmail.com&gt;</span><br><span class="line"><span class="comment">#작업 디렉토리</span></span><br><span class="line">WORKDIR /src</span><br><span class="line"><span class="comment">#원본 소스복사</span></span><br><span class="line">COPY ./freebex-integrated .</span><br><span class="line"><span class="comment"># npm 설치</span></span><br><span class="line">RUN npm install </span><br><span class="line"><span class="comment">#환경변수 NODE_ENV 의 값을 development 로 설정</span></span><br><span class="line"><span class="comment">#ENV NODE_ENV development</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#오픈할 포트 multi: EXPOSE 80 3000</span></span><br><span class="line">EXPOSE 3501</span><br><span class="line"><span class="comment">#CMD["npm","start"]</span></span><br><span class="line">CMD node ./bin/www</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>html on nginx<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#alpine image</span></span><br><span class="line">FROM nginx:alpine</span><br><span class="line"><span class="comment">#create the server and location configuration</span></span><br><span class="line">COPY default.conf /etc/nginx/conf.d/default.conf</span><br><span class="line"><span class="comment">#copies the build app to the default location</span></span><br><span class="line">COPY client/dist/mobile /usr/share/nginx/html</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h3 id="2-이미지-빌드"><a href="#2-이미지-빌드" class="headerlink" title="2. 이미지 빌드"></a>2. 이미지 빌드</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build --rm -f Dockerfile -t [image-name]:latest .</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-이미지-푸시-docker-hub"><a href="#3-이미지-푸시-docker-hub" class="headerlink" title="3. 이미지 푸시(docker hub)"></a>3. 이미지 푸시(docker hub)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker tag [image-name]:latest [docker-hub ID]/[image-name]:latest</span><br><span class="line">docker push [docker-hub ID]/[image-name]:latest</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/07/25/docker/" data-id="cjy7175pp0011dgnvxx1o1q7s" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kubernetest_dash" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/24/kubernetest_dash/" class="article-date">
  <time datetime="2018-07-24T08:24:13.000Z" itemprop="datePublished">2018-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kubernetes/">Kubernetes</a>
  </div>

  </div>
  <div class="article-inner">
      <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-8194749947474200"
      data-ad-slot="1037278219"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/24/kubernetest_dash/">[KUBERNETES] dashboard 설치</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="1-dashboard-admin-rbac-heapster-설치"><a href="#1-dashboard-admin-rbac-heapster-설치" class="headerlink" title="1. dashboard,admin-rbac, heapster 설치"></a>1. dashboard,admin-rbac, heapster 설치</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/DragOnMe/k8s-1.8-dashboard-heapster-mod.git</span><br><span class="line"><span class="built_in">cd</span> k8s-1.8.1-dashboard/</span><br><span class="line">kubectl apply -f kubernetes-dashboard.yaml</span><br><span class="line">kubectl apply -f kubernetes-dashboard-admin-rbac.yaml</span><br><span class="line"><span class="built_in">cd</span> ../</span><br><span class="line">kubectl apply -f k8s-heapster/</span><br><span class="line"></span><br><span class="line">[root@localhost k8s-1.8.1-dashboard]<span class="comment"># kubectl get pods -nkube-system -w</span></span><br><span class="line">NAME                                            READY     STATUS    RESTARTS   AGE</span><br><span class="line">heapster-dfd674df9-k6vr7                        1/1       Running   0          3d</span><br><span class="line">kubernetes-dashboard-5bd6f767c7-2h6wv           1/1       Running   0          2d</span><br><span class="line">monitoring-grafana-76848b566c-cts9n             1/1       Running   0          3d</span><br><span class="line">monitoring-influxdb-6c4b84d695-d8j4t            1/1       Running   0          3d</span><br></pre></td></tr></table></figure>
<p>kubernetes-dashboard.yaml 수정</p>
<ol>
<li>image 변경 (1.8.1 -&gt; 1.8.3)</li>
<li>service nodeport 설정<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: kubernetes-dashboard</span><br><span class="line">        image: k8s.gcr.io/kubernetes-dashboard-amd64:v1.8.3</span><br><span class="line">//==========================================================</span><br><span class="line"></span><br><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kube-system</span><br><span class="line">spec:</span><br><span class="line">  <span class="comment"># Added NodePort</span></span><br><span class="line">  <span class="built_in">type</span>: NodePort</span><br><span class="line">  ports:</span><br><span class="line">    - port: 443</span><br><span class="line">      targetPort: 8443</span><br><span class="line">      <span class="comment"># Added nodePort: 30000</span></span><br><span class="line">      nodePort: 30000</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h3 id="2-dashboard-접근-token-조회"><a href="#2-dashboard-접근-token-조회" class="headerlink" title="2. dashboard 접근 token 조회"></a>2. dashboard 접근 token 조회</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost]<span class="comment"># kubectl -n kube-system get secret | grep kubernetes-dashboard-admin</span></span><br><span class="line">kubernetes-dashboard-admin-token-mcx5k           kubernetes.io/service-account-token </span><br><span class="line">[root@localhost]<span class="comment"># kubectl describe -nkube-system secret kubernetes-dashboard-admin-token-mcx5k</span></span><br><span class="line">Name:         kubernetes-dashboard-admin-token-mcx5k</span><br><span class="line">Namespace:    kube-system</span><br><span class="line">Labels:       &lt;none&gt;</span><br><span class="line">Annotations:  kubernetes.io/service-account.name=kubernetes-dashboard-admin</span><br><span class="line">              kubernetes.io/service-account.uid=1d1aa7aa-30c1-11e8-a365-002590a7058c</span><br><span class="line"></span><br><span class="line">Type:  kubernetes.io/service-account-token</span><br><span class="line"></span><br><span class="line">Data</span><br><span class="line">====</span><br><span class="line">ca.crt:     1025 bytes</span><br><span class="line">namespace:  11 bytes</span><br><span class="line">token:      eyJhbGciOiJSUzI1NiIsInR....중략...</span><br><span class="line">FhyrXH_2ZZlAkYvm0oCT5VZMYCnKQ77NZEdyFXvZpsrXTA4BwfKyPFaFxUPKA</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-서버local이-아닌-브라우저에서-접근하기위해-nginx수정"><a href="#3-서버local이-아닌-브라우저에서-접근하기위해-nginx수정" class="headerlink" title="3. 서버local이 아닌 브라우저에서 접근하기위해 nginx수정"></a>3. 서버local이 아닌 브라우저에서 접근하기위해 nginx수정</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 443;</span><br><span class="line">        server_name &lt;접근호스트&gt;;</span><br><span class="line">        ssl on;</span><br><span class="line">        ssl_certificate /etc/kubernetes/pki/ca.crt;</span><br><span class="line">        ssl_certificate_key  /etc/kubernetes/pki/ca.key;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_pass https://&lt;master-ip&gt;:30000;</span><br><span class="line">                proxy_http_version 1.1;</span><br><span class="line">                proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">                proxy_set_header Connection <span class="string">'upgrade'</span>;</span><br><span class="line">                proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">                proxy_cache_bypass <span class="variable">$http_upgrade</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>

      
    </div>
    <footer class="article-footer">
        <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-8194749947474200"
        data-ad-slot="1037278219"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  
      <a data-url="https://skarlsla.github.io/2018/07/24/kubernetest_dash/" data-id="cjy7175q4001kdgnvjpr3zj6m" class="article-share-link">공유</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; 이전</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">다음 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">카테고리</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/DevOps/">DevOps</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kubernetes/">Kubernetes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/NODEJS/">NODEJS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/RabbitMq/">RabbitMq</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/patterns/">patterns</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/webserver/">webserver</a></li></ul>
    </div>
  </div>

    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">태그</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CD/">CD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CI/">CI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CI-CD/">CI/CD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EXPRESS/">EXPRESS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NODEJS/">NODEJS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/">WebSocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ack/">ack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cd/">cd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ci/">ci</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/">devops</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ingress/">ingress</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jenkins/">jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jwt/">jwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kubernetes/">kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth/">oauth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pattern/">pattern</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pipeline/">pipeline</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabbitmq/">rabbitmq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reply-to/">reply-to</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rpc/">rpc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/session/">session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/singleton/">singleton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typescript/">typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/배포/">배포</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/인증/">인증</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/타입스크립트/">타입스크립트</a></li></ul>
    </div>
  </div>

    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">태그 클라우드</h3>
    <div class="widget tagcloud">
      <a href="/tags/CD/" style="font-size: 15px;">CD</a> <a href="/tags/CI/" style="font-size: 10px;">CI</a> <a href="/tags/CI-CD/" style="font-size: 10px;">CI/CD</a> <a href="/tags/EXPRESS/" style="font-size: 10px;">EXPRESS</a> <a href="/tags/NODEJS/" style="font-size: 15px;">NODEJS</a> <a href="/tags/WebSocket/" style="font-size: 10px;">WebSocket</a> <a href="/tags/ack/" style="font-size: 10px;">ack</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/cd/" style="font-size: 17.5px;">cd</a> <a href="/tags/ci/" style="font-size: 15px;">ci</a> <a href="/tags/devops/" style="font-size: 12.5px;">devops</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/gitlab/" style="font-size: 10px;">gitlab</a> <a href="/tags/ingress/" style="font-size: 12.5px;">ingress</a> <a href="/tags/jenkins/" style="font-size: 17.5px;">jenkins</a> <a href="/tags/jwt/" style="font-size: 12.5px;">jwt</a> <a href="/tags/kubernetes/" style="font-size: 17.5px;">kubernetes</a> <a href="/tags/oauth/" style="font-size: 12.5px;">oauth</a> <a href="/tags/pattern/" style="font-size: 10px;">pattern</a> <a href="/tags/pipeline/" style="font-size: 10px;">pipeline</a> <a href="/tags/rabbitmq/" style="font-size: 10px;">rabbitmq</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/reply-to/" style="font-size: 10px;">reply-to</a> <a href="/tags/rpc/" style="font-size: 12.5px;">rpc</a> <a href="/tags/session/" style="font-size: 10px;">session</a> <a href="/tags/singleton/" style="font-size: 10px;">singleton</a> <a href="/tags/typescript/" style="font-size: 15px;">typescript</a> <a href="/tags/배포/" style="font-size: 20px;">배포</a> <a href="/tags/인증/" style="font-size: 12.5px;">인증</a> <a href="/tags/타입스크립트/" style="font-size: 12.5px;">타입스크립트</a>
    </div>
  </div>
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">아카이브</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">7월 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">5월 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">4월 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">8월 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">7월 2018</a></li></ul>
    </div>
  </div>

    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">최근 포스트</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/17/webserver-auth2/">[WEBSERVER] JWT(JSON WEB TOKEN)? </a>
          </li>
        
          <li>
            <a href="/2019/07/17/webserver-auth/">[WEBSERVER] session/cookie or token</a>
          </li>
        
          <li>
            <a href="/2019/07/11/jenkins-pipeline/">[JENKINS] pipeline 작성 </a>
          </li>
        
          <li>
            <a href="/2019/07/11/node-express-ws/">[NODEJS] EXPRESS(node.js) to WebSocket 세션 공유</a>
          </li>
        
          <li>
            <a href="/2019/07/11/pattern/">[TYPESCRIPT] 타입스크립트 디자인 패턴 - Singleton</a>
          </li>
        
      </ul>
    </div>
  </div>
    
    
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 NamGi YOON<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>